======================================================================

WHEN MOVING SITE TO NEW SERVER:

  mkdir log
  chmod 777 log

  chown charman config/environment.rb

  touch config/deliver_email

  ln -s google_maps_api_key.contactimprov_net.txt google_maps_api_key.txt

  Copy httpd.conf redirects  
    - /jams.html -> /jams
    - /events.html -> /events
    - /people.html -> /people


======================================================================

THIS COMMIT:



======================================================================

TODO:

@ Performance tuning
  - caching
    - index page for jams, organizations, people
    - events for iCalendar feeds
    - when a user is logged on, prevent the database from being
       queried with each page view
    - Google Maps
  - database optimization
    [...]

---

@ Calendars
  - iCal feeds
    - text for calendar subscription page
    - find icons for adding iCal calendars
    - for events with start/end dates greater than X, create separate
       start and end date events instead of having one giant event

@ Geocoding
  - update GeoKit settings in initializer file
  - admin page for locations that could not be geocoded
    - add links to actual actions
  - admin action to attempt to re-geocode
  - send admin an email if geocoding failed

@ Google Maps
  - caching
  - switch from JSON to XML
  - maps on more pages
    - [...]
  - links for directions to here, from here
  ...
  - map key explaining what the markers mean
    - figure out how to reduce size of key markers
    - change purple dot icon to something more explanatory
       (multi-colored icon with # of things?)
  - fix javascript warning message

---

@ Figure out why .text.erb email templates aren't being sent as plain
  text, and why settting:
    defaults :content_type => "text/plain"
  doesn't seem to be working 

@ Rewrite forms to use new(-to-project) Rails support for nested forms

@ Google search box for site
  - customize look and feel:
    http://code.google.com/intl/en/apis/customsearch/docs/ui.html
    - 
  [...]

@ Update 500 error page

@ Authlogic
  - functional testing
    - password resets
    - account activation process
    - old passwords still working
  [...]

@ Atom feeds

---

@ Configure mail delivery
  - can we move config options out of the user_mailer.rb
     filter_recipients() function?

@ Switch from YUI datatables to jQuery UI equivalent

@ preferred_url function - returns website for entry, otherwise CI.net link

@ email every user whose account status is pending - perhaps from
GMail account?

@ email obfuscation script:
    http://www.projecthoneypot.org/how_to_avoid_spambots_3.php

---

@ Get rid of CountryName.english_name_with_underscores, which is
deprecated thanks to the underlined_english_name database field

@ Create function for Events/People/etc to generate listing URL
  - refactor code in events_helper.rb

@ Account requests
  - remove white text box from home page
  - require users to provide one line description of what information 
     they want to add to the website

@ Fix left margin when viewing an entry

@ HTML entity decoding when editing forms
  - unit testing

@ Allow images to be added to listings
  [...]

@ Microformats
  - lat/lng
  - locations
  - events

@ Sort events by date
  - unit tests for 
    - EventEntry.find_by_year[_month]()
    - EventEntry.distinct_nonpast_years() 
    - EventEntry.distinct_nonpast_months()
  - functional tests for 
    - /events/list/YEAR[/MONTH]
  ...

@ Account request process
  - create page where people can check the status of their account requests
  - immediately send an email 
    - link to account request URL
  - on "request received" page
    - inform people to check their email accounts, check spam filters
    - provide link to URL

@ Entry listings
  - index pages for listings grouped by country
    - Google Maps
    - implement caching
  - 'preview' feature for editing/creating entries
  - OrganizationEntry model
    - make Location field optional
      - have section of /organizations/list for entries without a
         location 
    - additional fields
      - dance repertory company
      - commercial business
      - not-for-profit business
      - regional group
      - web group/presence
      ...
    - functional testing
  - JamEntry model
    - functional testing
  - PersonEntry model
    - additional fields
      ...
    - functional testing
  - add text to Entry pages explaining some simple Textile commands
    - add link to unhide a <div> with more formatting info (copy from
       BaseCamp Writeboards)
  - in listings controller, rename entry_display_name functions, since
     category_name_singular now actually fills that role (while a
     renamed entry_display_name is still needed for generating routes)

@ Allow people to list themselves as the contact person for an Entry
  - functional tests
  - integration tests

@ UI/text tweaks
  - change color of error messages
    - use Adobe Kuler site to find a less appalling shade of red
    ...

-- 

@ On /user/request_account page, if someone already has an account
with the listed email address, change error message to be less
confusing

@ Cache Entry list pages (/entries/list and /home/index)

--

@ When destroying an (*)Entry, the attached models are not deleted
  - delete the attached models iff they are "dangling"

@ email notification when Entry is modified
  - show what fields have changed

@ If someone goes to /#{entry_type}/edit instead of
/#{entry_type}/edit/ID, display a page listing all of the events that
they can edit for that type of entry

@ How to write automated tests that check if caching is working?

@ Refactor auto-complete location actions to separate controllers

@ Entry listings
  - validation function for "has at least one of these models"

@ Send email when rejecting a user account request

@ Copy/adapt:
  - models
    - Entry
    - Entity

@ Add FourOhFour model/controller


==[ LOG ]=============================================================

----[ day, May , 2011 ]--------------------------------------



----[ Wednesday, June  1, 2011 ]--------------------------------------

@ Finished migration of the code from Rails 2 to Rails 3, went live
with the Rails 3 version of the site.


----[ Monday, December 14, 2009 ]-------------------------------------

@ Found this sample code for implementing tabbed windows using the
Google Maps API v3 with jQuery:

  http://gmaps-samples-v3.googlecode.com/svn/trunk/infowindow/tabs.html



----[ Monday, January 26, 2009 ]--------------------------------------

@ Added a cron script:

  /etc/cron.daily/mysqldump_cq_rails

to back up the ci_rails MySQL database daily.


----[ Saturday, January 24, 2009 ]------------------------------------

@ Fixed a bug in my caching code were the cache wasn't being flushed
when modifying a non-US entry.

Since memcached is not flushed when Rails is restarted, had to restart
memcached on my laptop using:

  launchctl unload /Library/LaunchDaemons/org.macports.memcached.plist
  launchctl load /Library/LaunchDaemons/org.macports.memcached.plist


----[ Tuesday, January 20, 2009 ]-------------------------------------

@ Installed memcached on my MacBook Pro using:

  # port install memcached

which installed the program and gave the following error message:

  ###########################################################
  # A startup item has been generated that will aid in
  # starting memcached with launchd. It is disabled
  # by default. Execute the following command to start it,
  # and to cause it to launch at startup:
  #
  # sudo launchctl load -w
  # /Library/LaunchDaemons/org.macports.memcached.plist
  ###########################################################

Ran the command to have memcached start with launchd.

Installed the memcache-client gem:

  # gem install memcache-client

Changed the cache_store line in config/environment.rb to:

  ActionController::Base.cache_store = :mem_cache_store

Then modified config/environments/development.rb to enable caching for
the development environment:

  config.action_controller.perform_caching             = true


----[ Saturday, January 17, 2009 ]------------------------------------

@ Checked the contactimprov.net SPF record using:

  http://www.kitterman.com/spf/validate.html


----[ Thursday, January 15, 2009 ]------------------------------------

@ THE BIG SERVER SWITCH!

ContactImprov.net goes live on my server.


----[ Sunday, January 4, 2009 ]---------------------------------------

@ Installed the sanitize gem on my laptop.


----[ Saturday, January 3, 2009 ]-------------------------------------

@ Downloaded ContactImprov.net website using SiteSucker:

  http://www.sitesucker.us/home.html

@ Tried deploying the application to craigharman.net.

Updated rubygems from 1.2.0 to 1.3.1.

While running 'gem update', also updated Passenger from 2.0.5 to
2.0.6.  Ran the program:

  passenger-install-apache2-module

to compile a new Apache module for Passenger.  Updated httpd.conf.
Stopped Apache, then started it.

I try to access the website, but get a Passenger error page with the
error message:

  No such file or directory - /nonexistent

Found this post clamining that the error message was caused by a bugy
in RubyGems 1.3:

  http://groups.google.com/group/phusion-passenger/browse_thread/thread/dbb6711f24471527

The solution is apparently to make certain that environment.rb is now
owned by 'nobody' or 'root'.

Changed the owner of config/environment.rb to 'charman'.  I was then
able to access static pages, but got blank pages when trying to access
Rails actions, with this error message in the Apache logs:

  Error during failsafe response: Broken pipe
  (originally Broken pipe)
  [Sat Jan 03 21:36:46 2009] [error] [client 67.240.191.112] Premature end of script headers: 

I deleted the existing log files, and Rails then created new ones -
this time, owned by 'charman'.



----[ Tuesday, December 16, 2008 ]------------------------------------

@ Created Rails project, imported into Subversion.

@ I want to share some code between the ci_rails and cq_rails
projects.

I looked at the documentation for svn:externals:

  http://svnbook.red-bean.com/en/1.5/svn.advanced.externals.html

and then issued the following command:

  svn propedit svn:externals vendor/plugins

which opened up a text editor, where I added this line:

  acts_as_state_machine https://craigharman.net/svn/cq_rails/vendor/plugins/acts_as_state_machine

Subversion 1.5 supports a different syntax for svn:externals
properties, but Leopard still ships with Subversion 1.4, so I'm
currently sticking with the older syntax.

@ Took a quick look around for Rails date/time pickers.  There is an
amazing one hosted here:

  http://code.google.com/p/calendardateselect/

which can be installed using:

  gem install calendar_date_select


