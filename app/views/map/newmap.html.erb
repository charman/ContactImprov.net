<% content_for :head do %>
  <script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=false"></script>
  <script src="/javascripts/jquery.ui.map.js" type="text/javascript"></script>

  <script type="text/javascript">
    $(function() {
      $('#map_canvas').gmap({ 'center': new google.maps.LatLng(39.2083424, -76.53943019999997), 'streetViewControl': false, 'callback': function () {
        $.get('/map/newmap_feed.xml', function(xml_data) {
          $('listings', xml_data).children('listing').each(function() {
            var latitude  = $('latitude', this).text();
            var longitude = $('longitude', this).text();
            var title     = $('title', this).text();
            var latlng    = new google.maps.LatLng(latitude, longitude);

            $('#map_canvas').gmap('addMarker', {'position': latlng, 'title': title});
          });
        }, 'xml');
      }
    });
  });
  </script>
<% end %>

<div id="map_canvas" style="width: 100%; height: 500px; border: 1px solid #666;"></div>
